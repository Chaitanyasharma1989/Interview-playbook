## 2. Real-time Chat Application

**Situation:** You're developing a chat application that needs to handle multiple chat rooms with thousands of users.

**Questions:**
- How would you store active users in each chat room for fast membership checks?
- You need to maintain chat message history with timestamps. Which collection structure would you use?
- How would you implement a feature to find common friends between two users efficiently?
- For implementing a "typing indicator" that expires after 3 seconds of inactivity, what approach would you take?

**Follow-up:** How would you handle thread-safety when multiple users join/leave rooms simultaneously?